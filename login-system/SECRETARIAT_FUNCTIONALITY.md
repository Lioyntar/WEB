# Λειτουργικότητα Γραμματείας - Διαχείριση Διπλωματικών

## Επισκόπηση

Η Γραμματεία έχει πρόσβαση σε ειδικές λειτουργίες για τη διαχείριση διπλωματικών εργασιών, συμπεριλαμβανομένης της ενεργοποίησης και ακύρωσης διπλωματικών με καταχώρηση πληροφοριών Γενικής Συνέλευσης (ΓΣ).

## Προαπαιτούμενα

Πριν χρησιμοποιήσετε τη λειτουργικότητα, εκτελέστε τις ακόλουθες εντολές SQL στη βάση δεδομένων:

```sql
-- Προσθήκη πεδίων στη βάση δεδομένων
ALTER TABLE theses 
ADD COLUMN gs_number VARCHAR(50) NULL COMMENT 'Αριθμός ΓΣ για ενεργή κατάσταση',
ADD COLUMN gs_year VARCHAR(4) NULL COMMENT 'Έτος ΓΣ για ενεργή κατάσταση',
ADD COLUMN cancellation_reason TEXT NULL COMMENT 'Λόγος ακύρωσης (ελεύθερο κείμενο)';

-- Επιβεβαίωση πίνακα cancellations
ALTER TABLE cancellations 
ADD COLUMN IF NOT EXISTS cancelled_by ENUM('student', 'supervisor', 'secretariat') NOT NULL DEFAULT 'secretariat',
ADD COLUMN IF NOT EXISTS reason TEXT NULL COMMENT 'Λόγος ακύρωσης',
ADD COLUMN IF NOT EXISTS gs_number VARCHAR(50) NULL COMMENT 'Αριθμός ΓΣ',
ADD COLUMN IF NOT EXISTS gs_year VARCHAR(4) NULL COMMENT 'Έτος ΓΣ',
ADD COLUMN IF NOT EXISTS cancelled_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
```

## Λειτουργίες

### 1. Ενεργοποίηση Διπλωματικής

**Πότε:** Όταν μια διπλωματική είναι σε κατάσταση "υπό ανάθεση" και έχει εγκριθεί από τη ΓΣ.

**Τι κάνει:**
- Αλλάζει την κατάσταση σε "ενεργή"
- Καταχωρεί τον αριθμό και έτος ΓΣ
- Ορίζει την ημερομηνία επίσημης ανάθεσης

**Πώς:**
1. Επιλέξτε "Διαχείριση" στη διπλωματική
2. Συμπληρώστε αριθμό και έτος ΓΣ
3. Πατήστε "Ενεργοποίηση Διπλωματικής"

### 2. Ακύρωση Διπλωματικής

**Πότε:** Όταν χρειάζεται να ακυρωθεί μια διπλωματική για οποιονδήποτε λόγο.

**Τι κάνει:**
- Αλλάζει την κατάσταση σε "ακυρωμένη"
- Καταχωρεί τον αριθμό και έτος ΓΣ της ακύρωσης
- Αποθηκεύει τον λόγο ακύρωσης
- Δημιουργεί εγγραφή στον πίνακα cancellations

**Πώς:**
1. Επιλέξτε "Διαχείριση" στη διπλωματική
2. Συμπληρώστε αριθμό και έτος ΓΣ
3. Προαιρετικά, συμπληρώστε λόγο ακύρωσης
4. Πατήστε "Ακύρωση Διπλωματικής"

## Πεδία ΓΣ

### Αριθμός ΓΣ
- Μορφή: Κείμενο (π.χ. "123", "Α/123")
- Υποχρεωτικό για ενεργοποίηση και ακύρωση

### Έτος ΓΣ
- Μορφή: 4 ψηφία (π.χ. "2024")
- Υποχρεωτικό για ενεργοποίηση και ακύρωση

### Λόγος Ακύρωσης
- Προαιρετικό πεδίο
- Ελεύθερο κείμενο
- Παραδείγματα:
  - "κατόπιν αίτησης Φοιτητή/τριας"
  - "από Γραμματεία"
  - "λόγω αλλαγής κατεύθυνσης"

## Καταστάσεις Διπλωματικών

1. **υπό ανάθεση** - Μπορεί να ενεργοποιηθεί ή ακυρωθεί
2. **ενεργή** - Μπορεί μόνο να ακυρωθεί
3. **ακυρωμένη** - Δεν μπορεί να αλλάξει κατάσταση
4. **υπό εξέταση** - Μπορεί μόνο να ακυρωθεί
5. **περατωμένη** - Δεν μπορεί να αλλάξει κατάσταση

## API Endpoints

### POST /api/admin/theses/:thesisId/set-active
Ενεργοποίηση διπλωματικής με ΓΣ.

**Body:**
```json
{
  "gsNumber": "123",
  "gsYear": "2024"
}
```

### POST /api/admin/theses/:thesisId/cancel
Ακύρωση διπλωματικής με ΓΣ.

**Body:**
```json
{
  "gsNumber": "124",
  "gsYear": "2024",
  "reason": "κατόπιν αίτησης Φοιτητή/τριας"
}
```

### GET /api/admin/theses/:thesisId/details
Λήψη λεπτομερειών διπλωματικής με πληροφορίες ΓΣ.

## Ασφάλεια

- Μόνο χρήστες με ρόλο "Γραμματεία" έχουν πρόσβαση
- Όλες οι ενέργειες καταγράφονται
- Επιβεβαίωση κατάστασης πριν από αλλαγές

## Παρακολούθηση

Όλες οι ενέργειες καταγράφονται στον πίνακα `cancellations` με:
- Ημερομηνία/ώρα
- Ποιος έκανε την ενέργεια
- Λόγο (για ακυρώσεις)
- Πληροφορίες ΓΣ 